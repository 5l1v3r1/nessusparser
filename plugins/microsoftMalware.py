from plugins import genFile

def gen(cb):
	appendices = []

	plugin_ids=['Microsoft Malware Protection Engine < %']
	#	include_strings=["  Product name","  Path","  Version","  Engine version","  Antivirus signature version","  Antispyware signature version"]
	name="Microsoft Malware Protection Engine"
	description="A number of Windows hosts have been identified with an outdated variant of Microsoft Malware Protection Engine (MMPE) software installed. Outdated versions of this software are unable to identify newer malware threats, weakening the security posture of each affected host. Issues affecting the MMPE software directly have also been reported, some of which can be used to fully compromise the underlying host."
	risk_description="Hosts were found to have issues within the configuration of their Microsoft Malware Protection Engine (MMPE) installations. A lack of regular updates for the engine in use by these deployments are seen to prevent hosts from being able to detect more recently identified malicious content/activity and thus leaving them more susceptible to compromise in the event malicious content is accessed on the host. Additional issues affecting MMPE include those which can permit code execution or denial of service. An attacker capable of placing a crafted file on a host (e.g. by ticking a user into downloading it) could use such issues to remotely compromise the underlying host."
	recommendation="Ensure each deployment is kept in line with the most recent release. Microsoft typically release updates for this solution on a monthly basis."
	notes=str()

	ap = genFile.genr(cb, plugin_ids, name, description, risk_description, recommendation, notes)
	if not ap is None:
		appendices += ap



	if appendices:
		return appendices