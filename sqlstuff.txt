select reports.host_ip from reportitems INNER JOIN reports ON reports.report_id = reportitems.report_id WHERE reportitems.reports_pluginFamily == 'Windows : Microsoft Bulletins' OR reportitems.reports_pluginName LIKE 'MS0%' OR reportitems.reports_pluginName LIKE 'MS1%' OR reportitems.reports_pluginName LIKE 'MS1%' OR reportitems.reports_pluginName LIKE 'MS KB%' OR reportitems.reports_pluginName LIKE 'MSKB%' OR reportitems.reports_pluginName LIKE 'KB%' OR reportitems.reports_pluginName LIKE 'MS Security Advisory%' OR reportitems.reports_pluginName == 'Update for Microsoft EAP Implementation that Enables the Use of TLS' AND reportitems.reports_pluginName != 'Microsoft Patch Bulletin Feasibility Check' AND reportitems.reports_pluginName != 'Microsoft Windows Summary of Missing Patches'

results=self.store.find(Result,((Result.plugin_family == u"Windows : Microsoft Bulletins") | (Result.plugin_name.like(u"MS0%")) | (Result.plugin_name.like(u"MS %: Update%")) | (Result.plugin_name.like(u"MS1%")) | (Result.plugin_name.like(u"MS KB%")) | (Result.plugin_name.like(u"MSKB%")) | (Result.plugin_name.like(u"KB%")) | (Result.plugin_name.like(u"MS Security Advisory%")) | (Result.plugin_name == u"Update for Microsoft EAP Implementation that Enables the Use of TLS")) & (Result.scan_id.is_in(scan_ids)) & ((Result.plugin_name != u"Microsoft Patch Bulletin Feasibility Check")) & ((Result.plugin_name != u"Microsoft Windows Summary of Missing Patches")) & Result.severity > 0)
